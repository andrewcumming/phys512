Traceback (most recent call last):
  File "/opt/homebrew/lib/python3.11/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/opt/homebrew/lib/python3.11/site-packages/nbclient/client.py", line 1265, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/jupyter_core/utils/__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.11/3.11.4_1/Frameworks/Python.framework/Versions/3.11/lib/python3.11/asyncio/base_events.py", line 653, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/opt/homebrew/lib/python3.11/site-packages/nbclient/client.py", line 703, in async_execute
    await self.async_execute_cell(
  File "/opt/homebrew/lib/python3.11/site-packages/nbclient/client.py", line 1021, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/opt/homebrew/lib/python3.11/site-packages/nbclient/client.py", line 915, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# velocity and diffusion coefficient
v = 1
D = 0

# time to integrate
T = 1.0

plot_grid(v, D, T, 0.005)
plot_grid(v, D, T, 0.5)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mNameError[0m                                 Traceback (most recent call last)
Cell [0;32mIn[5], line 8[0m
[1;32m      5[0m [38;5;66;03m# time to integrate[39;00m
[1;32m      6[0m T [38;5;241m=[39m [38;5;241m1.0[39m
[0;32m----> 8[0m [43mplot_grid[49m[43m([49m[43mv[49m[43m,[49m[43m [49m[43mD[49m[43m,[49m[43m [49m[43mT[49m[43m,[49m[43m [49m[38;5;241;43m0.005[39;49m[43m)[49m
[1;32m      9[0m plot_grid(v, D, T, [38;5;241m0.5[39m)

Cell [0;32mIn[4], line 23[0m, in [0;36mplot_grid[0;34m(v, D, T, dt_frac)[0m
[1;32m     19[0m [38;5;28;01mfor[39;00m update [38;5;129;01min[39;00m updates:
[1;32m     20[0m 
[1;32m     21[0m     [38;5;66;03m# Gaussian[39;00m
[1;32m     22[0m     f_init [38;5;241m=[39m np[38;5;241m.[39mexp([38;5;241m-[39m(x[38;5;241m-[39m[38;5;241m0.5[39m)[38;5;241m*[39m[38;5;241m*[39m[38;5;241m2[39m[38;5;241m/[39m[38;5;241m0.05[39m[38;5;241m*[39m[38;5;241m*[39m[38;5;241m2[39m)
[0;32m---> 23[0m     f [38;5;241m=[39m [43mdo_integration[49m[43m([49m[43mf_init[49m[43m,[49m[43m [49m[43mdt[49m[43m,[49m[43m [49m[43mupdate[49m[43m [49m[38;5;241;43m=[39;49m[43m [49m[43mupdate[49m[43m)[49m
[1;32m     24[0m     plt[38;5;241m.[39msubplot([38;5;241m3[39m,[38;5;241m3[39m,count[38;5;241m*[39m[38;5;241m3[39m [38;5;241m+[39m [38;5;241m1[39m)
[1;32m     25[0m     plot_one(f_init, f)

Cell [0;32mIn[2], line 7[0m, in [0;36mdo_integration[0;34m(f_init, dt, update, make_plot)[0m
[1;32m      4[0m     get_ipython()[38;5;241m.[39mrun_line_magic([38;5;124m'[39m[38;5;124mmatplotlib[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124m'[39m)
[1;32m      6[0m g [38;5;241m=[39m np[38;5;241m.[39mfft[38;5;241m.[39mfft(f_init)
[0;32m----> 7[0m k [38;5;241m=[39m np[38;5;241m.[39mfft[38;5;241m.[39mfftfreq([43mn[49m) [38;5;241m*[39m [38;5;241m2[39m[38;5;241m*[39mnp[38;5;241m.[39mpi[38;5;241m/[39mdx
[1;32m      8[0m J [38;5;241m=[39m [38;5;28mcomplex[39m([38;5;241m0[39m,[38;5;241m1[39m)
[1;32m     10[0m nsteps [38;5;241m=[39m [38;5;28mint[39m(T[38;5;241m/[39mdt)

[0;31mNameError[0m: name 'n' is not defined
NameError: name 'n' is not defined

